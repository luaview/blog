<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>LuaView API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;lua&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="lua">lua</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/alibaba/LuaViewSDK'>LuaView In GitHub</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>LuaView 是 <strong>聚划算无线技术团队</strong> 的开源项目，其初衷是为了提升移动端应用动态化能力，提供比H5更好的用户体验，同时做到Android、iOS业务代码共用，减少同一业务的人员重复投入。</p>

<p>目前LuaView已经在聚划算大范围使用，先后经历了聚划算 3.8、6.6、9.9大促，已经服务过千万用户。使用LuaView的客户端能够具备H5同样的动态化能力，做到bug随时修，业务随时上，且在硬件交互，动画等功能上提供比H5更好的体验。</p>

<p>LuaView 使用Lua语言进行代码编写，目前支持两个端：Android和iOS。Android
端使用LuaJ引擎,iOS端使用LuaC引擎。</p>

<h1 id="design-principles">Design Principles</h1>

<p>几乎所有API既可以作为get函数调用，也可以作为set函数调用</p>

<ul>
<li>有参数的时候作为set函数调用，并返回对象本身（可供链式调用）</li>
<li>无参数的时候作为get函数调用，并返还调用返回值</li>
<li>时间单位是秒，毫秒通过小数来设置</li>
<li>所有尺寸单位为点（dot），而非真实像素（px）</li>
<li>容器类包含View的容器方法，非容器类没有View的容器方法</li>
</ul>
<pre class="highlight plaintext"><code>如：
 view.size(100, 100)  -- 设置view的大小为 w=100, h=100，返回view自身

 view.size()  -- 获取view的大小，返回 {w=100, h=100}
</code></pre>

          
          <h1 id="api-luaview">API-LuaView</h1>

<aside class="notice" id="luaview">
LuaView是外部使用LuaView的唯一主入口
</aside>

<blockquote>
<p>LuaView 使用 -Android</p>
</blockquote>
<pre class="highlight plaintext"><code>1. 创建LuaView
LuaView luaview = LuaView.create(getContext());

2. 注册扩展
luaview.registerPanel(CustomLoading.class);
luaview.register("bridge", new CustomBridge());

3. 加载资源
luaview.load("脚本uri");

如：
本地, luaview.load("main.lua"); //加载 assets下的main.lua
网络, luaview.load("http://luaview.github.com/test.zip"); //加载 网络资源test.zip，LuaView会自行下载并解压执行

</code></pre>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>create</td>
<td>context: Context</td>
<td>LuaView</td>
<td>Android</td>
<td>创建LuaView</td>
</tr>
<tr>
<td>createAsync</td>
<td>context: Context, callback: CreatedCallback</td>
<td>-</td>
<td>Android</td>
<td>异步创建LuaView</td>
</tr>
<tr>
<td>load</td>
<td>url: String</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定资源（asset、本地、网络）</td>
</tr>
<tr>
<td>load</td>
<td>url: String, callback: ScriptExecuteCallback</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定资源（asset、本地、网络），带回调</td>
</tr>
<tr>
<td>loadScript</td>
<td>script: String</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定脚本</td>
</tr>
<tr>
<td>loadScript</td>
<td>script: String, callback: ScriptExecuteCallback</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定脚本，带回调</td>
</tr>
<tr>
<td>loadScriptBundle</td>
<td>scriptBundle: ScriptBundle</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定脚本包</td>
</tr>
<tr>
<td>loadScriptBundle</td>
<td>scriptBundle: ScriptBundle, callback: ScriptExecuteCallback</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定脚本包，带回调</td>
</tr>
<tr>
<td>loadScriptBundle</td>
<td>scriptBundle: ScriptBundle, main_entry: String, callback: ScriptExecuteCallback</td>
<td>LuaView</td>
<td>Android</td>
<td>加载指定脚本包，执行main_entry入口文件，带回调</td>
</tr>
<tr>
<td>register</td>
<td>name: String, bridge: Object</td>
<td>LuaView</td>
<td>Android</td>
<td>注册一个名称为name的bridge对象</td>
</tr>
<tr>
<td>unregister</td>
<td>name: String</td>
<td>LuaView</td>
<td>Android</td>
<td>反注册一个名称为name的bridge对象</td>
</tr>
<tr>
<td>registerPanel</td>
<td>clazz: Class&lt;? extends LVCustomPanel&gt;</td>
<td>LuaView</td>
<td>Android</td>
<td>注册一个名称为clazz类名，类型为clazz的panel</td>
</tr>
<tr>
<td>registerPanel</td>
<td>name: String, clazz: Class&lt;? extends LVCustomPanel&gt;</td>
<td>LuaView</td>
<td>Android</td>
<td>注册一个名称为name，类型为clazz的panel</td>
</tr>
<tr>
<td>registerLibs</td>
<td>binders: LuaValue[]</td>
<td>LuaView</td>
<td>Android</td>
<td>注册自定义库</td>
</tr>
<tr>
<td>registerImageProvider</td>
<td>clazz: Class&lt;? extends ImageProvider&gt;</td>
<td>LuaView</td>
<td>Android</td>
<td>注册一个ImageProvider</td>
</tr>
<tr>
<td>getImageProvider</td>
<td>-</td>
<td>provider: ImageProvider</td>
<td>Android</td>
<td>获取ImageProvider</td>
</tr>
<tr>
<td>callLuaFunction</td>
<td>funName: String, params: Object[]</td>
<td>result: Object</td>
<td>Android</td>
<td>调用lua的某个全局函数</td>
</tr>
<tr>
<td>callWindowFunction</td>
<td>funName: String, params: Object[]</td>
<td>result: Varargs</td>
<td>Android</td>
<td>调用window.callback下的某个函数</td>
</tr>
<tr>
<td>getUri</td>
<td>-</td>
<td>uri: String</td>
<td>Android</td>
<td>获取当前LuaView加载的Uri</td>
</tr>
</tbody></table>

          <h1 id="api-ui">API-UI</h1>

<h2 id="view">View</h2>

<aside class="notice" id="view">
所有UI组件基类，容器。
</aside>

<blockquote>
<p>initParams</p>
</blockquote>
<pre class="highlight plaintext"><code>TableView().initParams({
})
</code></pre>

<blockquote>
<p>frame</p>
</blockquote>
<pre class="highlight plaintext"><code>view.frame(0, 0, 100, 100)
view.frame()
</code></pre>

<blockquote>
<p>padding</p>
</blockquote>
<pre class="highlight plaintext"><code>view.padding(5, 5, 5, 5)
</code></pre>

<blockquote>
<p>backgroundColor</p>
</blockquote>
<pre class="highlight plaintext"><code>view.backgroundColor(0xff0000, 0.5)
</code></pre>

<blockquote>
<p>align</p>
</blockquote>
<pre class="highlight plaintext"><code>view.align(Align.RIGHT, Align.BOTTOM)
</code></pre>

<blockquote>
<p>startAnimation</p>
</blockquote>
<pre class="highlight plaintext"><code>anim1 = Animation().alpha(1, 0).duration(1)
anim2 = Animation().scale(1, 0).duration(2).delay(0.2)
view.startAnimation(anim1, anim2)
</code></pre>

<blockquote>
<p>flexCss</p>
</blockquote>
<pre class="highlight plaintext"><code>view = View()
view.flexCss("margin-left: 10, sizetofit: 1, align-self: center")
</code></pre>

<blockquote>
<p>flxLayout</p>
</blockquote>
<pre class="highlight plaintext"><code>view = View()
view.flxLayout(true, function()
    print("do something")
end)
</code></pre>

<blockquote>
<p>effects</p>
</blockquote>
<pre class="highlight plaintext"><code>view.effects(ViewEffect.CLICK) -- 点击特效
view.effects(ViewEffect.CLICK, 0xff0000, 0.5) -- 点击特效，颜色红色，alpha=0.5
view.effects(ViewEffect.NONE) -- 无效果
</code></pre>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>initParams</td>
<td>table: LuaTable</td>
<td>-</td>
<td>Android</td>
<td>初始化参数</td>
</tr>
<tr>
<td>invalidate</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>强制重绘</td>
</tr>
<tr>
<td>padding</td>
<td>left: Number<br/>top: Number<br/>right: Number<br/>bottom: Number<br/></td>
<td>-</td>
<td>-</td>
<td>内边距</td>
</tr>
<tr>
<td>frame</td>
<td>x: Number<br/>y: Number<br/>width: Number<br/>height: Number</td>
<td>-</td>
<td>-</td>
<td>View尺寸</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>color: Number<br/> alpha: Number<br/></td>
<td>color, alpha</td>
<td>-</td>
<td>背景色&amp;alpha</td>
</tr>
<tr>
<td>size</td>
<td>width: Number<br/> height: Number<br/></td>
<td>width, height</td>
<td>-</td>
<td>尺寸</td>
</tr>
<tr>
<td>xy</td>
<td>x: Number<br/> y: Number<br/></td>
<td>x,y</td>
<td>-</td>
<td>x、y坐标</td>
</tr>
<tr>
<td>align</td>
<td>aligns[]: <a href="#align">Align</a></td>
<td>-</td>
<td>-</td>
<td>设置自身在父容器的布局</td>
</tr>
<tr>
<td>alignLeft</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Top</td>
</tr>
<tr>
<td>alignTop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Top</td>
</tr>
<tr>
<td>alignRight</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Top</td>
</tr>
<tr>
<td>alignBottom</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Bottom</td>
</tr>
<tr>
<td>alignLeftTop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Top</td>
</tr>
<tr>
<td>alignTopLeft</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Top</td>
</tr>
<tr>
<td>alignCenterTop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Center&amp;Top</td>
</tr>
<tr>
<td>alignTopCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Center&amp;Top</td>
</tr>
<tr>
<td>alignRightTop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Top</td>
</tr>
<tr>
<td>alignTopRight</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Top</td>
</tr>
<tr>
<td>alignLeftBottom</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Bottom</td>
</tr>
<tr>
<td>alignBottomLeft</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Bottom</td>
</tr>
<tr>
<td>alignCenterBottom</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Center&amp;Bottom</td>
</tr>
<tr>
<td>alignBottomCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Center&amp;Bottom</td>
</tr>
<tr>
<td>alignRightBottom</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Bottom</td>
</tr>
<tr>
<td>alignBottomRight</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Bottom</td>
</tr>
<tr>
<td>alignCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Center</td>
</tr>
<tr>
<td>alignLeftCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Center</td>
</tr>
<tr>
<td>alignCenterLeft</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Left&amp;Center</td>
</tr>
<tr>
<td>alignRightCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Center</td>
</tr>
<tr>
<td>alignCenterRight</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器Right&amp;Center</td>
</tr>
<tr>
<td>alignCenterHorizontal</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器center in horizontal</td>
</tr>
<tr>
<td>alignHorizontalCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器center in horizontal</td>
</tr>
<tr>
<td>alignCenterVertical</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器center in vertical</td>
</tr>
<tr>
<td>alignVerticalCenter</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>设置自身位于父容器center in vertical</td>
</tr>
<tr>
<td>center</td>
<td>x: Number<br/> y: Number</td>
<td>x, y</td>
<td>-</td>
<td>中心点坐标</td>
</tr>
<tr>
<td>x</td>
<td>x: Number</td>
<td>x</td>
<td>-</td>
<td>x坐标</td>
</tr>
<tr>
<td>y</td>
<td>y: Number</td>
<td>y</td>
<td>-</td>
<td>y坐标</td>
</tr>
<tr>
<td>left</td>
<td>left: Number</td>
<td>left</td>
<td>-</td>
<td>距离父容器左侧边距</td>
</tr>
<tr>
<td>top</td>
<td>top: Number</td>
<td>top</td>
<td>-</td>
<td>距离父容器上侧边距</td>
</tr>
<tr>
<td>right</td>
<td>right: Number</td>
<td>right</td>
<td>-</td>
<td>距离父容器右侧边距</td>
</tr>
<tr>
<td>bottom</td>
<td>bottom: Number</td>
<td>bottom</td>
<td>-</td>
<td>距离父容器底部边距</td>
</tr>
<tr>
<td>width</td>
<td>width: Number</td>
<td>width</td>
<td>-</td>
<td>宽度</td>
</tr>
<tr>
<td>minWidth</td>
<td>width: Number</td>
<td>width</td>
<td>-</td>
<td>最小宽度</td>
</tr>
<tr>
<td>height</td>
<td>height: Number</td>
<td>height</td>
<td>-</td>
<td>高度</td>
</tr>
<tr>
<td>centerX</td>
<td>x: Number</td>
<td>x</td>
<td>-</td>
<td>中心点x坐标</td>
</tr>
<tr>
<td>centerY</td>
<td>y: Number</td>
<td>y</td>
<td>-</td>
<td>中心点y坐标</td>
</tr>
<tr>
<td>visible</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>可见性</td>
</tr>
<tr>
<td>hidden</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>可见性</td>
</tr>
<tr>
<td>show</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>显示</td>
</tr>
<tr>
<td>isShow</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否可见</td>
</tr>
<tr>
<td>hide</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>隐藏</td>
</tr>
<tr>
<td>isHide</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否隐藏</td>
</tr>
<tr>
<td>enabled</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>是否可用</td>
</tr>
<tr>
<td>alpha</td>
<td>alpha: Number</td>
<td>alpha</td>
<td>-</td>
<td>透明度</td>
</tr>
<tr>
<td>borderWidth</td>
<td>width: Number</td>
<td>width</td>
<td>-</td>
<td>边框宽度</td>
</tr>
<tr>
<td>borderColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>边框颜色</td>
</tr>
<tr>
<td>clipsToBounds</td>
<td>v: Boolean</td>
<td>v</td>
<td>iOS</td>
<td>View边框是否剪接</td>
</tr>
<tr>
<td>shadowPath</td>
<td>v: Boolean</td>
<td>v</td>
<td>iOS</td>
<td>只对边框外部加阴影</td>
</tr>
<tr>
<td>masksToBounds</td>
<td>v: Boolean</td>
<td>v</td>
<td>iOS</td>
<td>设置边框是否裁剪</td>
</tr>
<tr>
<td>shadowOffset</td>
<td>v: Number</td>
<td>v</td>
<td>iOS</td>
<td>设置View阴影偏移位置</td>
</tr>
<tr>
<td>shadowRadius</td>
<td>v: Number</td>
<td>v</td>
<td>iOS</td>
<td>设置View阴影高斯模糊半径</td>
</tr>
<tr>
<td>shadowOpacity</td>
<td>v: Number</td>
<td>v</td>
<td>iOS</td>
<td>设置View阴影透明度</td>
</tr>
<tr>
<td>shadowColor</td>
<td>v: Number</td>
<td>v</td>
<td>iOS</td>
<td>设置View阴影颜色</td>
</tr>
<tr>
<td>sizeToFit</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>适应View内容的大小</td>
</tr>
<tr>
<td>addGestureRecognizer</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>添加手势</td>
</tr>
<tr>
<td>removeGestureRecognizer</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>移除手势</td>
</tr>
<tr>
<td>transform3D</td>
<td>v: Number[]</td>
<td>-</td>
<td>iOS</td>
<td>设置3D变换矩阵</td>
</tr>
<tr>
<td>anchorPoint</td>
<td>x: Number<br/> y: Number</td>
<td>-</td>
<td>-</td>
<td>锚点</td>
</tr>
<tr>
<td>removeFromSuper</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>从父容器移除</td>
</tr>
<tr>
<td>removeFromParent</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>从父容器移除</td>
</tr>
<tr>
<td>hasFocus</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否有焦点</td>
</tr>
<tr>
<td>requestFocus</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>请求焦点</td>
</tr>
<tr>
<td>clearFocus</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>取消焦点</td>
</tr>
<tr>
<td>rotation</td>
<td>v: Number</td>
<td>-</td>
<td>-</td>
<td>旋转角度</td>
</tr>
<tr>
<td>rotationXY</td>
<td>rx: Number<br/>ry: Number</td>
<td>rx, ry</td>
<td>-</td>
<td>根据x坐标和y坐标得到的旋转角度，pivot</td>
</tr>
<tr>
<td>scale</td>
<td>sx: Number<br/>sy: Number</td>
<td>sx, sy</td>
<td>-</td>
<td>x，y缩放</td>
</tr>
<tr>
<td>scaleX</td>
<td>sx: Number</td>
<td>sx</td>
<td>-</td>
<td>x坐标缩放</td>
</tr>
<tr>
<td>scaleY</td>
<td>sy: Number</td>
<td>sy</td>
<td>-</td>
<td>y坐标缩放</td>
</tr>
<tr>
<td>translation</td>
<td>tx: Number<br/> ty: Number</td>
<td>x, y</td>
<td>-</td>
<td>x、y位移</td>
</tr>
<tr>
<td>translationX</td>
<td>tx: Number</td>
<td>tx</td>
<td>-</td>
<td>x坐标位移</td>
</tr>
<tr>
<td>translationY</td>
<td>ty: Number</td>
<td>ty</td>
<td>-</td>
<td>y坐标位移</td>
</tr>
<tr>
<td>bringToFront</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>将view设置到前台</td>
</tr>
<tr>
<td>scrollTo</td>
<td>sx: Number<br/>sy: Number</td>
<td>-</td>
<td>-</td>
<td>滚动到某个位置</td>
</tr>
<tr>
<td>scrollBy</td>
<td>sx: Number<br/>sy: Number</td>
<td>-</td>
<td>-</td>
<td>移动一段距离</td>
</tr>
<tr>
<td>scrollX</td>
<td>sx: Number</td>
<td>sx</td>
<td>-</td>
<td>x方向滚动到某个位置</td>
</tr>
<tr>
<td>offsetX</td>
<td>sx: Number</td>
<td>sx</td>
<td>-</td>
<td>x方向滚动到某个位置</td>
</tr>
<tr>
<td>scrollY</td>
<td>sy: Number</td>
<td>sy</td>
<td>-</td>
<td>y方向滚动到某个位置</td>
</tr>
<tr>
<td>offsetY</td>
<td>sy: Number</td>
<td>sy</td>
<td>-</td>
<td>y方向滚动到某个位置</td>
</tr>
<tr>
<td>scrollXY</td>
<td>sx: Number<br/> sy: Number</td>
<td>sx, sy</td>
<td>-</td>
<td>x、y方向移动到某个位置</td>
</tr>
<tr>
<td>offsetXY</td>
<td>sx: Number<br/> sy: Number</td>
<td>sx, sy</td>
<td>-</td>
<td>x、y方向移动到某个位置</td>
</tr>
<tr>
<td>offset</td>
<td>sx: Number<br/> sy: Number</td>
<td>sx, sy</td>
<td>-</td>
<td>x、y方向移动到某个位置</td>
</tr>
<tr>
<td>showScrollIndicator</td>
<td>h: Boolean<br/> v: Boolean</td>
<td>h, v</td>
<td>-</td>
<td>设置滚动条是否显示（横向、纵向）</td>
</tr>
<tr>
<td>callback</td>
<td>v: LuaTable</td>
<td>v</td>
<td>-</td>
<td>监听view的各种事件</td>
</tr>
<tr>
<td>onClick</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>设置view的点击事件</td>
</tr>
<tr>
<td>onLongClick</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>设置view的长按事件</td>
</tr>
<tr>
<td>adjustSize</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>调整大小以适应内容</td>
</tr>
<tr>
<td>cornerRadius</td>
<td>radius: Number</td>
<td>radius</td>
<td>-</td>
<td>设置边框圆角半径</td>
</tr>
<tr>
<td>startAnimation</td>
<td>anims: <a href="#animation">Animation[]</a></td>
<td>-</td>
<td>-</td>
<td>开始播放动画</td>
</tr>
<tr>
<td>stopAnimation</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止动画播放</td>
</tr>
<tr>
<td>isAnimating</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否正在播放动画</td>
</tr>
<tr>
<td>flexCss</td>
<td>v: String</td>
<td>v</td>
<td>-</td>
<td>设置flex属性</td>
</tr>
<tr>
<td>flxLayout</td>
<td>v: String</td>
<td>v</td>
<td>iOS</td>
<td>设置flex布局</td>
</tr>
<tr>
<td>effects</td>
<td>effect: <a href="#view_effect">ViewEffect</a><br/> color: Number<br/> alpha: Number</td>
<td>effect</td>
<td>-</td>
<td>设置view的特效</td>
</tr>
<tr>
<td>nativeView</td>
<td>-</td>
<td>v: Object</td>
<td>-</td>
<td>获取NativeView</td>
</tr>
</tbody></table>

<p><strong>作为容器的额外方法</strong></p>

<blockquote>
<p>onShow</p>
</blockquote>
<pre class="highlight plaintext"><code>view.onShow(function()
    print("i am show")
end)
</code></pre>

<blockquote>
<p>onHide</p>
</blockquote>
<pre class="highlight plaintext"><code>view.onHide(function()
    print("i am hide")
end)
</code></pre>

<blockquote>
<p>onBack</p>
</blockquote>
<pre class="highlight plaintext"><code>view.onBack(function()
    print("back pressed")
end)
</code></pre>

<blockquote>
<p>onLayout</p>
</blockquote>
<pre class="highlight plaintext"><code>view.onLayout(function()
    print("i am layouted")
end)
</code></pre>

<blockquote>
<p>addView</p>
</blockquote>
<pre class="highlight plaintext"><code>child = View()
parent = View()
parent.addView(child)
</code></pre>

<blockquote>
<p>removeView</p>
</blockquote>
<pre class="highlight plaintext"><code>child = View()
parent = View()
parent.addView(child)
parent.removeView(child)
</code></pre>

<blockquote>
<p>removeAllViews</p>
</blockquote>
<pre class="highlight plaintext"><code>child = View()
parent = View()
parent.addView(child)
parent.removeAllViews()
</code></pre>

<blockquote>
<p>children</p>
</blockquote>
<pre class="highlight plaintext"><code>parent.children(function(parent) -- 所有在函数里创建的View都会被自动添加到parent里
    view = View()
    ...
end)
</code></pre>

<blockquote>
<p>flexChildren</p>
</blockquote>
<pre class="highlight plaintext"><code>child1 = View()
child2 = View()
parent = View()
parent.flexChildren(child1, child2)
</code></pre>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>onShow</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>显示监听</td>
</tr>
<tr>
<td>onHide</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>隐藏监听</td>
</tr>
<tr>
<td>onBack</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>返回按钮监听</td>
</tr>
<tr>
<td>onLayout</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>布局监听</td>
</tr>
<tr>
<td>addView</td>
<td>v: <a href="#view">View</a></td>
<td>-</td>
<td>-</td>
<td>添加子View</td>
</tr>
<tr>
<td>removeView</td>
<td>v: <a href="#view">View</a></td>
<td>-</td>
<td>-</td>
<td>移除子View</td>
</tr>
<tr>
<td>removeAllViews</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>移除所有子View</td>
</tr>
<tr>
<td>children</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>子View构造函数</td>
</tr>
<tr>
<td>flexChildren</td>
<td>v: <a href="#view">View[]</a></td>
<td>-</td>
<td>-</td>
<td>Flexbox 设置childViews</td>
</tr>
</tbody></table>

<h2 id="label">Label</h2>

<aside class="notice" id="label">
文本组件，非容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>text</td>
<td>v: String/<a href="#styled_string">StyledString/<a href="#unicode">Unicode</a></td>
<td>v</td>
<td>-</td>
<td>Label文本</td>
</tr>
<tr>
<td>textColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>文本颜色</td>
</tr>
<tr>
<td>textSize</td>
<td>size: Number</td>
<td>size</td>
<td>-</td>
<td>文本字体大小</td>
</tr>
<tr>
<td>fontSize</td>
<td>size: Number</td>
<td>size</td>
<td>-</td>
<td>文本字体大小</td>
</tr>
<tr>
<td>fontName</td>
<td>name: String</td>
<td>name</td>
<td>-</td>
<td>文本字体</td>
</tr>
<tr>
<td>font</td>
<td>name: String<br/> size: Number</td>
<td>name, size</td>
<td>-</td>
<td>文本字体&amp;大小</td>
</tr>
<tr>
<td>gravity</td>
<td>v: <a href="#gravity">Gravity</a></td>
<td>v</td>
<td>-</td>
<td>文本对齐方式</td>
</tr>
<tr>
<td>textAlign</td>
<td>v: <a href="#text_align">TextAlign</a></td>
<td>v</td>
<td>-</td>
<td>文本对齐方式</td>
</tr>
<tr>
<td>lines</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>文字行数</td>
</tr>
<tr>
<td>maxLines</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>文本最大行数</td>
</tr>
<tr>
<td>lineCount</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>文本最大行数</td>
</tr>
<tr>
<td>minLines</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>文本最小行数</td>
</tr>
<tr>
<td>ellipsize</td>
<td>v: <a href="#ellipsize">Ellipsize</a></td>
<td>v</td>
<td>-</td>
<td>文本省略方式</td>
</tr>
<tr>
<td>adjustTextSize</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>字体大小适应宽度</td>
</tr>
<tr>
<td>adjustFontSize</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>字体大小适应宽度</td>
</tr>
</tbody></table>

<h2 id="button">Button</h2>

<aside class="notice" id="button">
按钮组件，非容器。
-> <a href="#label">Label</a>
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>v: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></td>
<td>v</td>
<td>-</td>
<td>按钮文字</td>
</tr>
<tr>
<td>titleColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>image</td>
<td>img1: String<br/> img2: String</td>
<td>img1, img2</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>showsTouchWhenHighlighted</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>获取按钮点击是否高亮</td>
</tr>
</tbody></table>

<h2 id="image">Image</h2>

<aside class="notice" id="image">
图片组件，非容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>image</td>
<td>v: String, c: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>设置图片url（本地、网络），回调</td>
</tr>
<tr>
<td>contentMode</td>
<td>type: <a href="#scale_type">ScaleType</a></td>
<td>type</td>
<td>-</td>
<td>图片缩放模式</td>
</tr>
<tr>
<td>scaleType</td>
<td>type: <a href="#scale_type">ScaleType</a></td>
<td>type</td>
<td>-</td>
<td>图片缩放模式</td>
</tr>
<tr>
<td>startAnimationImages</td>
<td>images: String[]</td>
<td>-</td>
<td>-</td>
<td>帧动画（本地图）</td>
</tr>
<tr>
<td>stopAnimationImages</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止播放帧动画</td>
</tr>
<tr>
<td>isAnimationImages</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>是否正在播放帧动画</td>
</tr>
</tbody></table>

<h2 id="textfield">TextField</h2>

<aside class="notice" id="text_field">
输入框组件，非容器。
-> <a href="#label">Label</a>
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>hint</td>
<td>v: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></td>
<td>v</td>
<td>-</td>
<td>提示</td>
</tr>
<tr>
<td>placeholder</td>
<td>v: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></td>
<td>v</td>
<td>-</td>
<td>提示</td>
</tr>
</tbody></table>

<h2 id="tableview">TableView</h2>

<aside class="notice" id="table_view">
(Deprecated see <a href="#collection_view">CollectionView</a>)
<br/>
基础列表组件，容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>reload</td>
<td>section: Number<br/> row: Number<br/></td>
<td>-</td>
<td>-</td>
<td>Android支持参数</td>
</tr>
<tr>
<td>contentSize</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>设置内容区域大小</td>
</tr>
<tr>
<td>contentOffset</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>设置内容偏移</td>
</tr>
<tr>
<td>contentInset</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>设置ContentInset</td>
</tr>
<tr>
<td>showScrollIndicator</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>是否显示滚动条信息</td>
</tr>
<tr>
<td>scrollToTop</td>
<td>offset: Number<br/> animate: Boolean</td>
<td>-</td>
<td>-</td>
<td>滚动到顶部(offset间隔，animate是否动画)</td>
</tr>
<tr>
<td>scrollToCell</td>
<td>section: Number<br/> rowInSection: Number<br/> offset: Number<br/> animate: Boolean</td>
<td>-</td>
<td>-</td>
<td>滚动到指定cell，offset间隔，animate是否动画</td>
</tr>
<tr>
<td>miniSpacing</td>
<td>space: Number</td>
<td>space</td>
<td>-</td>
<td>cell间隙</td>
</tr>
<tr>
<td>lazyLoad</td>
<td>v: Boolean</td>
<td>-</td>
<td>-</td>
<td>是否懒加载Cell</td>
</tr>
<tr>
<td>header</td>
<td>v: <a href="#view">View</a></td>
<td>-</td>
<td>-</td>
<td>设置Header，nil的时候清空header</td>
</tr>
<tr>
<td>footer</td>
<td>v: <a href="#view">View</a></td>
<td>-</td>
<td>-</td>
<td>设置Footer，nil的时候清空footer</td>
</tr>
<tr>
<td>dividerHeight</td>
<td>v: Number</td>
<td>height: Number</td>
<td>height</td>
<td>-</td>
</tr>
</tbody></table>

<h2 id="collectionview">CollectionView</h2>

<aside class="notice" id="collection_view">
基础列表组件，容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>reload</td>
<td>section: Number<br/> row: Number<br/></td>
<td>-</td>
<td>-</td>
<td>Android支持参数</td>
</tr>
<tr>
<td>contentSize</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>设置内容区域大小</td>
</tr>
<tr>
<td>contentOffset</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>设置内容偏移</td>
</tr>
<tr>
<td>contentInset</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>设置ContentInset</td>
</tr>
<tr>
<td>showScrollIndicator</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>是否显示滚动条信息</td>
</tr>
<tr>
<td>scrollToTop</td>
<td>offset: Number<br/> animate: Boolean</td>
<td>-</td>
<td>-</td>
<td>滚动到顶部(offset间隔，animate是否动画)</td>
</tr>
<tr>
<td>scrollToCell</td>
<td>section: Number<br/> rowInSection: Number<br/> offset: Number<br/> animate: Boolean</td>
<td>-</td>
<td>-</td>
<td>滚动到指定cell，offset间隔，animate是否动画</td>
</tr>
<tr>
<td>miniSpacing</td>
<td>space: Number</td>
<td>space</td>
<td>-</td>
<td>cell间隙</td>
</tr>
<tr>
<td>lazyLoad</td>
<td>v: Boolean</td>
<td>-</td>
<td>-</td>
<td>是否懒加载Cell</td>
</tr>
</tbody></table>

<h2 id="refreshtableview">RefreshTableView</h2>

<aside class="notice" id="refresh_table_view">
(Deprecated see <a href="#refresh_collection_view">RefreshCollectionView</a>)
<br/>
可刷新列表组件，容器。
-> <a href="#table_view">TableView</a>
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>refreshEnable</td>
<td>v: Boolean</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>initRefreshing</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>初始化刷新组件</td>
</tr>
<tr>
<td>isRefreshing</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否正在刷新</td>
</tr>
<tr>
<td>startRefreshing</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始刷新</td>
</tr>
<tr>
<td>stopRefreshing</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止刷新</td>
</tr>
</tbody></table>

<h2 id="refreshcollectionview">RefreshCollectionView</h2>

<aside class="notice" id="refresh_collection_view">
可刷新列表组件，容器。
-> <a href="#collection_view">CollectionView</a>
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>refreshEnable</td>
<td>v: Boolean</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>initRefreshing</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>初始化刷新组件</td>
</tr>
<tr>
<td>isRefreshing</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否正在刷新</td>
</tr>
<tr>
<td>startRefreshing</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始刷新</td>
</tr>
<tr>
<td>stopRefreshing</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止刷新</td>
</tr>
</tbody></table>

<h2 id="pagerview">PagerView</h2>

<aside class="notice" id="pager_view">
页面组组件，容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>reload</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>重新加载数据</td>
</tr>
<tr>
<td>indicator</td>
<td>v: <a href="#pager_indicator">PagerIndicator</a></td>
<td>-</td>
<td>-</td>
<td>设置页面组指示器</td>
</tr>
<tr>
<td>currentPage</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>设置/获取当前页</td>
</tr>
<tr>
<td>currentItem</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>设置/获取当前页</td>
</tr>
<tr>
<td>autoScroll</td>
<td>duration: Number</td>
<td>-</td>
<td>-</td>
<td>自动轮播</td>
</tr>
<tr>
<td>looping</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>自动轮播</td>
</tr>
</tbody></table>

<h2 id="pagerindicator">PagerIndicator</h2>

<aside class="notice" id="pager_indicator">
页面组指示器组件，非容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>unselectedColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>未选中指示器颜色</td>
</tr>
<tr>
<td>selectedColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>选中指示器颜色</td>
</tr>
<tr>
<td>fillColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>未选中指示器颜色</td>
</tr>
<tr>
<td>pageColor</td>
<td>color: Number</td>
<td>color</td>
<td>-</td>
<td>选中指示器颜色</td>
</tr>
<tr>
<td>strokeWidth</td>
<td>width: Number</td>
<td>width</td>
<td>Android</td>
<td>线条宽度</td>
</tr>
<tr>
<td>strokeColor</td>
<td>color: Number</td>
<td>color</td>
<td>Android</td>
<td>线条颜色</td>
</tr>
<tr>
<td>radius</td>
<td>v: Number</td>
<td>v</td>
<td>Android</td>
<td>圆点半径</td>
</tr>
<tr>
<td>snap</td>
<td>v: Boolean</td>
<td>v</td>
<td>Android</td>
<td>是否有点移动动画</td>
</tr>
<tr>
<td>currentPage</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>设置/获取当前页面</td>
</tr>
<tr>
<td>currentItem</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>设置/获取当前页面</td>
</tr>
</tbody></table>

<h2 id="custompagerindicator">CustomPagerIndicator</h2>

<aside class="notice" id="custom_pager_indicator">
(Deprecated)
<br/>
自定义页面组指示器组件，非容器，Android特有。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>currentPage</td>
<td>v: Number</td>
<td>v</td>
<td>Android</td>
<td>设置/获取当前页面</td>
</tr>
<tr>
<td>currentItem</td>
<td>v: Number</td>
<td>v</td>
<td>Android</td>
<td>设置/获取当前页面</td>
</tr>
</tbody></table>

<h2 id="custompanel">CustomPanel</h2>

<aside class="notice" id="custom_pager_indicator">
自定义组件，容器。
-> <a href="#view">View</a>
</aside>

<p>供第三方扩展用，不可直接创建。第三方通过扩展CustomPanel，实现已有的 Native UI 组件与 lua 互操作。</p>

<p>扩展后的CustomPanel，有所有View容器的API，如 frame、size、backgroundColor 等。</p>

<blockquote>
<p>CustomPanel 扩展 - Android</p>
</blockquote>
<pre class="highlight plaintext"><code>1. 扩展LVCustomPanel，创建Native UI，并将创建出来的View添加到CustomPanel里

public class CustomLoading extends LVCustomPanel {

    public CustomLoading(Globals globals, LuaValue metaTable, Varargs varargs) {
        super(globals, metaTable, varargs);
    }

    @Override
    public void initPanel() {
        final View customLoading = new NativeLoading(getContext());
        LayoutParams layoutParams = LuaViewUtil.createRelativeLayoutParamsWW();
        layoutParams.addRule(RelativeLayout.CENTER_IN_PARENT);
        customLoading.setVisibility(View.VISIBLE);
        addView(customLoading, layoutParams);
    }
}

2. 使用LuaView对象初始化的时候注册该 CustomPanel

luaview.registerPanel(CustomLoading.class)

或

luaview.registerPanel("CustomLoading", CustomLoading.class)

3. 在lua里使用该 CustomPanel，CustomPanel有所有View的api

local loading = CustomLoading()
loading.frame(0, 0, 100, 100)

</code></pre>

<h2 id="hscrollview">HScrollView</h2>

<aside class="notice" id="h_scroll_view">
横向滑动组件，容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>offset</td>
<td>x: Number<br/> y: Number<br/> smooth: Boolean</td>
<td>x, y</td>
<td>-</td>
<td>滚动到x,y，smooth表示是否平滑滚动</td>
</tr>
<tr>
<td>scrollTo</td>
<td>x: Number<br/> y: Number<br/> smooth: Boolean</td>
<td>-</td>
<td>-</td>
<td>滚动到x,y，smooth表示是否平滑滚动</td>
</tr>
<tr>
<td>offsetBy</td>
<td>dx: Number<br/> dy: Number<br/> smooth: Boolean</td>
<td>x, y</td>
<td>-</td>
<td>滚动dx,dy，smooth表示是否平滑滚动</td>
</tr>
<tr>
<td>scrollBy</td>
<td>dx: Number<br/> dy: Number<br/> smooth: Boolean</td>
<td>-</td>
<td>-</td>
<td>滚动dx,dy，smooth表示是否平滑滚动</td>
</tr>
<tr>
<td>smoothScrollTo</td>
<td>x: Number<br/> y: Number</td>
<td>-</td>
<td>-</td>
<td>平滑滚动到x,y</td>
</tr>
<tr>
<td>smoothScrollBy</td>
<td>x: Number<br/> y: Number</td>
<td>-</td>
<td>-</td>
<td>滚动到x,y</td>
</tr>
<tr>
<td>pageScroll</td>
<td>direction: Number</td>
<td>-</td>
<td>Android</td>
<td>滚动一页(direction&gt;0右滚，否则左滚)</td>
</tr>
<tr>
<td>fullScroll</td>
<td>direction: Number</td>
<td>-</td>
<td>Android</td>
<td>滚动到底(direction&gt;0右滚，否则左滚)</td>
</tr>
<tr>
<td>contentSize</td>
<td>-</td>
<td>-</td>
<td>iOS</td>
<td>内容区域大小</td>
</tr>
</tbody></table>

<h2 id="webview">WebView</h2>

<aside class="notice" id="web_view">
html组件，容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>loadUrl</td>
<td>v: String</td>
<td>-</td>
<td>-</td>
<td>加载url</td>
</tr>
<tr>
<td>canGoBack</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否可以回退</td>
</tr>
<tr>
<td>canGoForward</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否可以前进</td>
</tr>
<tr>
<td>goBack</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>回退一页</td>
</tr>
<tr>
<td>goForward</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>前进一页</td>
</tr>
<tr>
<td>reload</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>重新加载</td>
</tr>
<tr>
<td>title</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>获取Title</td>
</tr>
<tr>
<td>isLoading</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否正在加载</td>
</tr>
<tr>
<td>stopLoading</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止加载</td>
</tr>
<tr>
<td>url</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>获取url</td>
</tr>
<tr>
<td>pullRefreshEnable</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>是否可以下拉刷新</td>
</tr>
</tbody></table>

<h2 id="loadingindicator">LoadingIndicator</h2>

<aside class="notice" id="loading_indicator">
加载指示器组件，容器。
-> <a href="#view">View</a>
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>start</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始转动</td>
</tr>
<tr>
<td>isStart</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否开始转动</td>
</tr>
<tr>
<td>startAnimating</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始转动</td>
</tr>
<tr>
<td>isAnimating</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否在动画中</td>
</tr>
<tr>
<td>stop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止动画</td>
</tr>
<tr>
<td>stopAnimating</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止动画</td>
</tr>
<tr>
<td>color</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>颜色</td>
</tr>
</tbody></table>

<h2 id="loadingdialog">LoadingDialog</h2>

<aside class="notice" id="loading_dialog">
加载对话框组件。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始转动</td>
</tr>
<tr>
<td>isShow</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否开始转动</td>
</tr>
<tr>
<td>start</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始转动</td>
</tr>
<tr>
<td>isStart</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否开始转动</td>
</tr>
<tr>
<td>startAnimating</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始转动</td>
</tr>
<tr>
<td>isAnimating</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否开始转动</td>
</tr>
<tr>
<td>hide</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止动画</td>
</tr>
<tr>
<td>stop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止动画</td>
</tr>
<tr>
<td>stopAnimating</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止动画</td>
</tr>
<tr>
<td>color</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>颜色</td>
</tr>
</tbody></table>

<h2 id="alert">Alert</h2>

<blockquote>
<p>Alert</p>
</blockquote>
<pre class="highlight plaintext"><code>Alert("提示", "这是一个提示", "OK", function()
    print("OK clicked")
end)


Alert("提示", "这是一个提示", "OK", "Cancel", function()
    print("OK clicked")
end, function()
    print("Cancel clicked")
end)


local as1 = StyledString("一个按钮", { fontColor = 0xffff0000, backgroundColor = 0xff00ff00, fontSize = 30 })
local text = StyledString("文字", { fontColor = 0xffff0000, backgroundColor = 0xff00ff00, fontSize = 30 })
local ok = StyledString("确定", { fontColor = 0xffff0000, backgroundColor = 0xff00ff00, fontSize = 30 })
Alert(as1, text, ok, function()
    print("点击了")
end)
</code></pre>

<aside class="notice" id="alert">
对话框组件。
</aside>

<p>Alert(title, content, buttonTexts[], buttonCallbacks[])</p>

<ul>
<li>title: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></li>
<li>content: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></li>
<li>buttonTexts[]: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a> []</li>
<li>buttonCallbacks[]: LuaFunction[]</li>
</ul>

<h2 id="toast">Toast</h2>

<blockquote>
<p>Toast</p>
</blockquote>
<pre class="highlight plaintext"><code>Toast("测试")

Toast(StyledString("测试", {fontColor=0xffff0000, backgroundColor=0xff00ff00, fontSize=50}))
</code></pre>

<aside class="notice" id="toast">
提示信息组件。
</aside>

<p>Toast(message)</p>

<ul>
<li>message: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></li>
</ul>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>show</td>
<td>v: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></td>
<td>-</td>
<td>-</td>
<td>显示提示</td>
</tr>
</tbody></table>

<h2 id="styledstring">StyledString</h2>

<blockquote>
<p>StyledString</p>
</blockquote>
<pre class="highlight plaintext"><code>StyledString("test", { fontColor = 0xff0000ff, fontSize = 14 })

StyledString(Unicode(0xe607), { fontColor = 0xff00aaff, fontStyle = "bold" })
</code></pre>

<aside class="notice" id="styled_string">
富文本组件。
</aside>

<p>StyledString(text, config)</p>

<ul>
<li>text: String/<a href="#unicode">Unicode</a></li>
<li>config: LuaTable

<ul>
<li>fontSize: Number, 文字大小</li>
<li>fontColor: Number, 文字颜色</li>
<li>fontName: String, 文字样式</li>
<li>fontWeight: Number/<a href="#font_weight">FontWeight</a>, 文字权重</li>
<li>fontStyle: String/<a href="#font_style">FontStyle</a>，文字样式</li>
<li>backgroundColor: Number, 文字背景色</li>
<li>strikethrough: Boolean，是否删除线</li>
<li>underline: Boolean，是否下划线</li>
</ul></li>
</ul>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>append</td>
<td>v: <a href="#styled_string">StyledString</a></td>
<td>v</td>
<td>-</td>
<td>新增一段</td>
</tr>
</tbody></table>

<h2 id="animation">Animation</h2>

<blockquote>
<p>Animation</p>
</blockquote>
<pre class="highlight plaintext"><code>-- alpha动画
Animation().scale(2, 0.5).duration(2).delay(1)

-- 位移动画
view = View()
Animation().with(view).translation(100, -100).duration(3).interpolator(Interpolator.ACCELERATE_DECELERATE).callback({
    onStart = function()
        print("Running")
    end,
    onCancel = function()
        print("Canceled")
    end,
    onEnd = function()
        print("End")
    end,
    onPause = function()
        print("Paused")
    end,
    onResume = function()
        print("Running")
    end,
})
</code></pre>

<aside class="notice" id="animation">
动画组件。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>with</td>
<td>v: <a href="#view">View</a></td>
<td>-</td>
<td>-</td>
<td>设置动画target</td>
</tr>
<tr>
<td>start</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>开始动画</td>
</tr>
<tr>
<td>alpha</td>
<td>v0: Number<br/> v1: Number</td>
<td>-</td>
<td>-</td>
<td>设置alpha动画</td>
</tr>
<tr>
<td>rotation</td>
<td>v0: Number<br/> v1: Number</td>
<td>-</td>
<td>-</td>
<td>设置旋转动画</td>
</tr>
<tr>
<td>scale</td>
<td>x: Number<br/> y: Number</td>
<td>-</td>
<td>-</td>
<td>设置缩放动画(x轴缩放比、y轴缩放比)</td>
</tr>
<tr>
<td>scaleX</td>
<td>x: Number<br/></td>
<td>-</td>
<td>-</td>
<td>设置x轴缩放动画</td>
</tr>
<tr>
<td>scaleY</td>
<td>y: Number<br/></td>
<td>-</td>
<td>-</td>
<td>设置y轴缩放动画</td>
</tr>
<tr>
<td>translation</td>
<td>x: Number<br/> y: Number<br/></td>
<td>-</td>
<td>-</td>
<td>设置x轴、y轴位移动画</td>
</tr>
<tr>
<td>translationX</td>
<td>x: Number</td>
<td>-</td>
<td>-</td>
<td>设置x轴位移动画</td>
</tr>
<tr>
<td>translationY</td>
<td>y: Number</td>
<td>-</td>
<td>-</td>
<td>设置y轴位移动画</td>
</tr>
<tr>
<td>duration</td>
<td>time: Number</td>
<td>-</td>
<td>-</td>
<td>设置动画时长</td>
</tr>
<tr>
<td>delay</td>
<td>time: Number</td>
<td>-</td>
<td>-</td>
<td>设置动画启动延时</td>
</tr>
<tr>
<td>repeatCount</td>
<td>count: Number</td>
<td>-</td>
<td>-</td>
<td>设置动画重复测试（&lt;0表示一直重复）</td>
</tr>
<tr>
<td>interpolator</td>
<td>v: <a href="#interlator">Interplator<a/></td>
<td>-</td>
<td>-</td>
<td>插值器</td>
</tr>
<tr>
<td>cancel</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>取消动画</td>
</tr>
<tr>
<td>pause</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>暂停动画</td>
</tr>
<tr>
<td>isPaused</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>动画是否暂停</td>
</tr>
<tr>
<td>isRunning</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>动画是否运行</td>
</tr>
<tr>
<td>resume</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>恢复动画</td>
</tr>
<tr>
<td>reverses</td>
<td>v: Boolean</td>
<td>-</td>
<td>-</td>
<td>动画重复播放时是否反转</td>
</tr>
<tr>
<td>values</td>
<td>v: Number[]</td>
<td>-</td>
<td>-</td>
<td>设置动画用到的参数</td>
</tr>
<tr>
<td>callback</td>
<td>v: LuaTable</td>
<td>-</td>
<td>-</td>
<td>设置动画的回调</td>
</tr>
<tr>
<td>onStart</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>动画开始回调</td>
</tr>
<tr>
<td>onEnd</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>动画结束回调</td>
</tr>
<tr>
<td>onRepeat</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>动画重复回调</td>
</tr>
<tr>
<td>onCancel</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>动画取消回调</td>
</tr>
<tr>
<td>onPause</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>动画暂停回调</td>
</tr>
<tr>
<td>onUpdate</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>Android</td>
<td>动画状态更新回调</td>
</tr>
<tr>
<td>onResume</td>
<td>v: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>动画恢复回调</td>
</tr>
</tbody></table>

<h2 id="navigation">Navigation</h2>

<blockquote>
<p>Navigation</p>
</blockquote>
<pre class="highlight plaintext"><code>Navigation.title("测试view")


img = Image();
img.image("http://gtms02.alicdn.com/tps/i2/TB1qmXnHpXXXXcuaXXXQG.m0FXX-640-128.jpg",function()
    Navigation.background(img)
end);
</code></pre>

<aside class="notice" id="animation">
导航条组件，静态。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>v: String/<a href="#styled_string">StyledString</a>/<a href="#unicode">Unicode</a></td>
<td>v</td>
<td>-</td>
<td>导航条标题</td>
</tr>
<tr>
<td>background</td>
<td>v: String/<a href="#image">Image</a></td>
<td>-</td>
<td>-</td>
<td>设置导航条背景</td>
</tr>
<tr>
<td>left</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>显示左侧按钮</td>
</tr>
<tr>
<td>right</td>
<td>v: Boolean</td>
<td>v</td>
<td>-</td>
<td>显示右侧按钮</td>
</tr>
</tbody></table>

<h2 id="canvas">Canvas</h2>

<blockquote>
<p>Canvas</p>
</blockquote>
<pre class="highlight plaintext"><code>local view = CustomView() -- onDraw方法需要配合CustomView使用
view.onDraw(function(canvas)
    print(canvas)
    -- drawLine
    canvas.color(0xff0000)
    canvas.strokeWidth(2)
    canvas.drawLine(0, 50, 100, 50)
    canvas.drawLine(50, 0, 50, 100)

    canvas.resetPaint()
    canvas.color(0x00ff00)
    canvas.alpha(0.5)
    canvas.drawLine(0, 0, 100, 0)
    canvas.drawLine(100, 0, 100, 100)
    canvas.drawLine(100, 100, 0, 100)
    canvas.drawLine(0, 100, 0, 0)
    canvas.drawLine(0, 0, 100, 100)
    canvas.drawLine(100, 0, 0, 100)

    -- drawPoint
    canvas.color(0xff0000)
    canvas.strokeWidth(2)
    canvas.drawPoint(1, 5)
    canvas.drawPoint(99, 93)

    -- drawRect
    canvas.resetPaint()
    canvas.style(PaintStyle.STROKE)
    canvas.drawRect(5, 5, 5, 5)
    canvas.style(PaintStyle.FILL)
    canvas.drawRect(10, 10, 5, 5)

    -- drawRoundRects
    canvas.drawRoundRect(45, 1, 5, 5, 2, 2)
    canvas.drawRoundRect(45, 5, 10, 5, 2, 2)

    -- drawCircle
    canvas.drawCircle(80, 0, 5)
    canvas.drawCircle(80, 15, 5)

    -- drawText
    canvas.textSize(20)
    canvas.drawText("x", 20, 55)
    canvas.textSize(14)
    canvas.drawText("y", 20, 65)
    canvas.resetPaint()

    -- drawOval
    canvas.drawOval(45, 50, 25, 10)
    canvas.drawOval(45, 60, 25, 10)

    -- draw Arc
    canvas.drawArc(30, 30, 20, 20, 0, 90, true)

    -- drawBitmap
    canvas.save()
    canvas.rotate(-10, 100, 100)
    canvas.scale(1.2)
    canvas.translate(-10, -10)
    canvas.strokeWidth(10)
    canvas.textSize(15)
    canvas.bold(true)
    canvas.drawText("测试一下", 20, 150)
    canvas.alpha(0.5)
    canvas.drawImage("animate1", 0, 100, 100, 100)
    canvas.restore()
    canvas.resetPaint()

    print(img)
    if(img) then
            canvas.drawImage(img, 100, 0, 100, 100)
    end

    -- clipRect
    canvas.clipRect(100, 100, 35, 35)
    canvas.drawCircle(100, 100, 40)

    canvas.clipRect(150, 150, 30, 30)
    canvas.drawText("TestABCDEFGHEFGHIJKLMOPQRST", 150, 150)

    print(canvas.nativeObj())
end)



-- ps
1. Android所有绘制API支持同时多个参数，如：
canvas.drawLine({
        { 0, 0, 100, 0 },
        { 100, 0, 100, 100 },
        { 100, 100, 0, 100 },
        { 0, 100, 0, 0 },
        { 0, 0, 100, 100 },
        { 100, 0, 0, 100 }
    })
2. Android所有绘制API支持设置绘制参数，如：      
canvas.drawText({
        { "xx", 20, 75, { color = 0x0000ff, strikeThrough = true, textSize = 20, textSkewX = 1.5, bold = true } },
        { "yy", 20, 85 },
    }, { color = 0x0fff00, underline = true, textSize = 10, textScaleX = 3, letterSpacing = 0.2, linearText = true })
</code></pre>

<aside class="notice" id="canvas">
自定义绘制组件。
</aside>

<h3 id="a-api">a. 绘制API</h3>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>drawLine</td>
<td>x1: Number<br/> y1: Number<br/> x2: Number<br/> y2: Number<br/></td>
<td>-</td>
<td>-</td>
<td>绘制线条。(x1,y1), (x2, y2)分别为起点终点</td>
</tr>
<tr>
<td>drawPoint</td>
<td>x: Number<br/> y: Number<br/></td>
<td>-</td>
<td>-</td>
<td>绘制点</td>
</tr>
<tr>
<td>drawRect</td>
<td>x: Number<br/> y: Number<br/> w: Number<br/> h: Number<br/></td>
<td>-</td>
<td>-</td>
<td>绘制矩形。x起点x坐标，y起点y坐标，w宽度，h高度</td>
</tr>
<tr>
<td>drawRoundRect</td>
<td>x: Number<br/> y: Number<br/> w: Number<br/> h: Number<br/> rx: Number<br/> ry: Number<br/></td>
<td>-</td>
<td>-</td>
<td>绘制圆角矩形。x起点x坐标，y起点y坐标，w宽度，h高度，rx为x轴圆角半径，ry为y轴圆角半径</td>
</tr>
<tr>
<td>drawCircle</td>
<td>x: Number<br/> y: Number<br/> r: Number</td>
<td>-</td>
<td>-</td>
<td>绘制圆。(x, y)为圆心坐标，r为半径</td>
</tr>
<tr>
<td>drawOval</td>
<td>x: Number<br/> y: Number<br/> rx: Number<br/> ry: Number</td>
<td>-</td>
<td>-</td>
<td>绘制椭圆。(x, y)为圆心坐标，rx, ry为椭圆半径</td>
</tr>
<tr>
<td>drawArc</td>
<td>x: Number<br/> y: Number<br/> w: Number<br/> h: Number<br/> startAngle: Number<br/> sweepAngle: Number<br/> useCenter: Boolean</td>
<td>-</td>
<td>-</td>
<td>绘制扇形。(x,y)为左上角坐标，(w,h)为扇形宽高，startAngle为开始角度，sweepAngle为覆盖角度, useCenter为是否覆盖完整扇形面积（默认为false）</td>
</tr>
<tr>
<td>drawText</td>
<td>text: String/<a href="#styled_string">StyledString<a/>/<a href="#unicode">Unicode<a/> <br/> x: Number<br/> y:Number</td>
<td>-</td>
<td>-</td>
<td>绘制文本</td>
</tr>
<tr>
<td>drawImage</td>
<td>image: String/<a href="#image">Image</a> <br/> x: Number<br/> y: Number<br/> w: Number<br/> h: Number</td>
<td>-</td>
<td>-</td>
<td>绘制图片，支持本地图和Image对象</td>
</tr>
</tbody></table>

<h3 id="b-api">b. 画笔属性API</h3>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>color</td>
<td>color: Number</td>
<td>-</td>
<td>-</td>
<td>设置画笔颜色</td>
</tr>
<tr>
<td>alpha</td>
<td>alpha: Number</td>
<td>-</td>
<td>-</td>
<td>设置画笔透明度</td>
</tr>
<tr>
<td>strokeWidth</td>
<td>w: Number</td>
<td>-</td>
<td>-</td>
<td>设置画笔粗细</td>
</tr>
<tr>
<td>style</td>
<td>style: <a href="#paint_style">PaintStyle</a></td>
<td>-</td>
<td>-</td>
<td>设置画笔填充样式</td>
</tr>
<tr>
<td>textSize</td>
<td>size: Number</td>
<td>-</td>
<td>-</td>
<td>设置文本字体大小</td>
</tr>
<tr>
<td>font</td>
<td>name: String</td>
<td>-</td>
<td>-</td>
<td>设置字体名称</td>
</tr>
<tr>
<td>bold</td>
<td>bold: Boolean</td>
<td>-</td>
<td>-</td>
<td>设置是否粗体</td>
</tr>
<tr>
<td>resetPaint</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>重置画笔所有属性</td>
</tr>
</tbody></table>

<h3 id="c-api">c. 画布变换API</h3>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>translate</td>
<td>dx: Number<br/> dy: Number</td>
<td>-</td>
<td>-</td>
<td>位移变换，dx为x轴移动距离，dy为y轴移动距离</td>
</tr>
<tr>
<td>scale</td>
<td>sx: Number<br/> sy: Number</td>
<td>-</td>
<td>-</td>
<td>缩放变换，sx为x轴缩放比率，sy为y轴缩放比率</td>
</tr>
<tr>
<td>rotate</td>
<td>r: Number<br/> x: Number <br/> y: Number</td>
<td>-</td>
<td>-</td>
<td>旋转变换，r为角度；(x,y) 坐标（可选）</td>
</tr>
<tr>
<td>skew</td>
<td>x: Number<br/> y: Number<br/></td>
<td>-</td>
<td>-</td>
<td>斜切变换，xy斜切比率</td>
</tr>
</tbody></table>

<h3 id="d-api">d. 其它API</h3>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>nativeObj</td>
<td>-</td>
<td>native canvas</td>
<td>-</td>
<td>获取对应的native对象</td>
</tr>
<tr>
<td>save</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>保存当前画布状态</td>
</tr>
<tr>
<td>restore</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>恢复当前画布状态</td>
</tr>
<tr>
<td>clipRect</td>
<td>left: Number<br/> top: Number<br/> right: Number<br/> bottom: Number</td>
<td>-</td>
<td>-</td>
<td>裁剪矩形区域</td>
</tr>
</tbody></table>

          <h1 id="api-nui">API-NUI</h1>

<h2 id="http">Http</h2>

<blockquote>
<p>Http</p>
</blockquote>
<pre class="highlight plaintext"><code>Http({
    "method": "POST",
    "params": {
        "k1": "v1",
        "k2": "v2"
    }
}, function(response)
    print("called success")
end)


http = Http()
http.get("http://luaview.github.io", {
    query = 1
}, function(response)
    print("called success")
end)
</code></pre>

<aside class="notice" id="nhttp">
网络请求组件。
</aside>

<p>Http(initParams, callback)</p>

<ul>
<li>initParams: LuaTable，请求参数

<ul>
<li>method: String, 请求方法</li>
<li>params: LuaTable, 请求业务参数</li>
</ul></li>
<li>callback: LuaFunction, 回调

<ul>
<li>返回参数response为LuaTable</li>
<li>response.data() 得到 Data数据</li>
</ul></li>
</ul>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>v: String</td>
<td>v</td>
<td>-</td>
<td>设置请求Url</td>
</tr>
<tr>
<td>method</td>
<td>v: String, get/post</td>
<td>v</td>
<td>-</td>
<td>设置请求方法</td>
</tr>
<tr>
<td>retryTimes</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>重试次数</td>
</tr>
<tr>
<td>timeout</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>超时时间</td>
</tr>
<tr>
<td>params</td>
<td>v: LuaTable</td>
<td>v</td>
<td>-</td>
<td>请求参数</td>
</tr>
<tr>
<td>callback</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>请求回调</td>
<td></td>
</tr>
<tr>
<td>request</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>请求</td>
</tr>
<tr>
<td>cancel</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>中止</td>
</tr>
<tr>
<td>get</td>
<td>url: String<br/> params: LuaTable<br/> callback: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>GET请求</td>
</tr>
<tr>
<td>post</td>
<td>url: String<br/> params: LuaTable<br/> callback: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>POST请求</td>
</tr>
</tbody></table>

<h2 id="timer">Timer</h2>

<aside class="notice" id="timer">
定时器组件。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>delay</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>启动延时</td>
</tr>
<tr>
<td>repeat</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>重复次数</td>
</tr>
<tr>
<td>repeatCount</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>重复次数</td>
</tr>
<tr>
<td>interval</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>重复间隔</td>
</tr>
<tr>
<td>start</td>
<td>v: Number</td>
<td>v</td>
<td>-</td>
<td>启动</td>
</tr>
<tr>
<td>callback</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>回调</td>
</tr>
<tr>
<td>cancel</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>取消</td>
</tr>
</tbody></table>

<h2 id="system">System</h2>

<aside class="notice" id="system">
系统信息组件，静态。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>ios</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否iOS平台</td>
</tr>
<tr>
<td>android</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否Android平台</td>
</tr>
<tr>
<td>vmVersion</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>LuaView版本</td>
</tr>
<tr>
<td>osVersion</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>操作系统版本</td>
</tr>
<tr>
<td>platform</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>平台系统型号</td>
</tr>
<tr>
<td>scale</td>
<td>-</td>
<td>v: Number</td>
<td>-</td>
<td>屏幕缩放比</td>
</tr>
<tr>
<td>device</td>
<td>-</td>
<td>v: LuaTable</td>
<td>-</td>
<td>设备信息</td>
</tr>
<tr>
<td>screenSize</td>
<td>-</td>
<td>w: Number<br/> h: Number</td>
<td>-</td>
<td>屏幕尺寸</td>
</tr>
<tr>
<td>network</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>网络类型(&ldquo;none&rdquo;, &ldquo;2g&rdquo;, &ldquo;3g&rdquo;, &ldquo;4g&rdquo;, &ldquo;wifi&rdquo;, &ldquo;unknown&rdquo;)</td>
</tr>
<tr>
<td>gc</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>执行内存回收</td>
</tr>
<tr>
<td>keepScreenOn</td>
<td>v: Boolean</td>
<td>-</td>
<td>-</td>
<td>是否保持屏幕常亮</td>
</tr>
</tbody></table>

<h2 id="audioplayer">AudioPlayer</h2>

<aside class="notice" id="audio_player">
音频播放器组件。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>play</td>
<td>name: String<br/> times: Number</td>
<td>-</td>
<td>-</td>
<td>播放（uri，重复次数）</td>
</tr>
<tr>
<td>pause</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>暂停播放</td>
</tr>
<tr>
<td>resume</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>恢复播放</td>
</tr>
<tr>
<td>stop</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>停止播放</td>
</tr>
<tr>
<td>seekTo</td>
<td>sec: Number</td>
<td>-</td>
<td>-</td>
<td>到某个位置</td>
</tr>
<tr>
<td>callback</td>
<td>v: LuaFunction</td>
<td>v</td>
<td>-</td>
<td>回调</td>
</tr>
<tr>
<td>playing</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否播放</td>
</tr>
<tr>
<td>pausing</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否暂停</td>
</tr>
<tr>
<td>looping</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否循环播放</td>
</tr>
</tbody></table>

<h2 id="vibrator">Vibrator</h2>

<blockquote>
<p>Vibrator</p>
</blockquote>
<pre class="highlight plaintext"><code>local vibrator = Vibrator()

vibrator.vibrate() -- 默认震动

vibrator.vibrate(2) -- 震动两次

vibrator.vibrate({1, 2, 1, 0.3, 0.2, 0.1, 0.01, 1.1}, 4) -- 特殊震动模式
</code></pre>

<aside class="notice" id="vibrator">
震动组件。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>hasVibrator</td>
<td>-</td>
<td>v: Boolean</td>
<td>-</td>
<td>是否有震动硬件</td>
</tr>
<tr>
<td>vibrate</td>
<td>mode: Number[], repeatTimes: Number</td>
<td>-</td>
<td>-</td>
<td>震动(模式，次数)</td>
</tr>
<tr>
<td>cancel</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>取消震动</td>
</tr>
</tbody></table>

<h2 id="unicode">Unicode</h2>

<blockquote>
<p>Unicode</p>
</blockquote>
<pre class="highlight plaintext"><code>Unicode(0xe607)
</code></pre>

<aside class="notice" id="unicode">
unicode组件。
</aside>

<p>Unicode(char)</p>

<ul>
<li>char 为Unicode字符编码</li>
</ul>

<h2 id="data">Data</h2>

<blockquote>
<p>Data</p>
</blockquote>
<pre class="highlight plaintext"><code>Data("a")

Data(97, "abc", "def")

Data('{"a":"1"}')

Data('a').toString("latin-1")

Data('{"a":"1"}').toTable()

Data('{"a":"1"}').toJson()
</code></pre>

<aside class="notice" id="data">
二进制数据组件。
</aside>

<p>Data(str)</p>

<ul>
<li>str: String/JsonString</li>
</ul>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>append</td>
<td>v: Data/byte[]</td>
<td>-</td>
<td>-</td>
<td>新增部分数据</td>
</tr>
<tr>
<td>toString</td>
<td>code: String</td>
<td>v: String</td>
<td>-</td>
<td>转成String(编码格式)</td>
</tr>
<tr>
<td>toJson</td>
<td>-</td>
<td>v: String</td>
<td>-</td>
<td>转成Json String</td>
</tr>
<tr>
<td>toTable</td>
<td>-</td>
<td>v: LuaTable</td>
<td>-</td>
<td>转成LuaTable</td>
</tr>
</tbody></table>

<h2 id="json">Json</h2>

<aside class="notice" id="json">
Json组件，静态。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>toTable</td>
<td>v: String/<a href="#data">Data</a>/LuaTable</td>
<td>r: LuaTable</td>
<td>-</td>
<td>给定内容转成LuaTable</td>
</tr>
<tr>
<td>isValid</td>
<td>v: String/<a href="#data">Data</a></td>
<td>r: Boolean</td>
<td>-</td>
<td>是否有效JsonString</td>
</tr>
</tbody></table>

<h2 id="file">File</h2>

<blockquote>
<p>File</p>
</blockquote>
<pre class="highlight plaintext"><code>http = Http()
http.get("http://luaview.github.io", {
    query = 1
}, function(response)
  local data = response:data()

    -- 保存
    File.save(data, "test.html") -- 同步存
    File.save(data, "test.html", function(status)
        -- 异步存
    end)

    -- 读取
    data = File.read("test.html") -- 同步读
    File.read("test.html", function(data)
        -- 异步读取
    end)

    -- 存在判断
    print(File.exists("test.html"))

    -- 文件路径
    print(File.path("test.html"))
end)
</code></pre>

<aside class="notice" id="file">
文件操作组件，静态。
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>save</td>
<td>path: String<br/> data: <a href="#data">Data<a/> <br/> callback: LuaFunction or <br/> data: <a href="#data">Data<a/> <br/> path: String<br/> callback: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>保存data内数据到path指定的文件内，文件名支持子目录或者上级目录</td>
</tr>
<tr>
<td>read</td>
<td>path: String<br/> callback: LuaFunction</td>
<td><a href="#data">Data</a></td>
<td>-</td>
<td>读取给定path的文件，并返回Data数据，支持异步读取，异步返回数据通过callback返回</td>
</tr>
<tr>
<td>exists</td>
<td>path: String</td>
<td>-</td>
<td>-</td>
<td>文件是否存在</td>
</tr>
<tr>
<td>path</td>
<td>name: filename</td>
<td>path:String</td>
<td>-</td>
<td>获取给定文件名的绝对存储路径</td>
</tr>
</tbody></table>

<h2 id="downloader">Downloader</h2>

<aside class="notice" id="downloader">
下载器组件，静态。
(Deprecated 所有功能可以通过<a href="#http">Http</a> and <a href="#file">File</a>完成)
</aside>

<table><thead>
<tr>
<th>API</th>
<th>参数</th>
<th>返回值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>fetch</td>
<td>url: String<br/> name: String<br/> callback: LuaFunction</td>
<td>-</td>
<td>-</td>
<td>TODO</td>
</tr>
</tbody></table>

          <h1 id="api-constants">API-Constants</h1>

<h2 id="align">Align</h2>

<aside class="notice" id="align">
View布局。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>LEFT</td>
<td>-</td>
<td>左对齐</td>
</tr>
<tr>
<td>TOP</td>
<td>-</td>
<td>顶对齐</td>
</tr>
<tr>
<td>RIGHT</td>
<td>-</td>
<td>右对齐</td>
</tr>
<tr>
<td>BOTTOM</td>
<td>-</td>
<td>底对齐</td>
</tr>
<tr>
<td>CENTER</td>
<td>-</td>
<td>整体居中</td>
</tr>
<tr>
<td>H_CENTER</td>
<td>-</td>
<td>水平居中</td>
</tr>
<tr>
<td>V_CENTER</td>
<td>-</td>
<td>垂直居中</td>
</tr>
<tr>
<td>START</td>
<td>-</td>
<td>左or上对齐</td>
</tr>
<tr>
<td>END</td>
<td>-</td>
<td>右or下对齐</td>
</tr>
</tbody></table>

<h2 id="textalign">TextAlign</h2>

<aside class="notice" id="text_align">
文本布局。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>LEFT</td>
<td>-</td>
<td>左&amp;垂直居中</td>
</tr>
<tr>
<td>RIGHT</td>
<td>-</td>
<td>整体居中</td>
</tr>
<tr>
<td>CENTER</td>
<td>-</td>
<td>右&amp;垂直居中</td>
</tr>
</tbody></table>

<h2 id="fontweight">FontWeight</h2>

<aside class="notice" id="font_weight">
字体大小。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>NORMAL</td>
<td>-</td>
<td>正常</td>
</tr>
<tr>
<td>BOLD</td>
<td>-</td>
<td>粗体</td>
</tr>
</tbody></table>

<h2 id="fontstyle">FontStyle</h2>

<aside class="notice" id="font_style">
字体样式。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>NORMAL</td>
<td>-</td>
<td>正常</td>
</tr>
<tr>
<td>ITALIC</td>
<td>-</td>
<td>斜体</td>
</tr>
<tr>
<td>BOLD</td>
<td>-</td>
<td>粗体</td>
</tr>
</tbody></table>

<h2 id="scaletype">ScaleType</h2>

<aside class="notice" id="scale_type">
图片样式。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>FIT_XY</td>
<td>-</td>
<td>左上铺满</td>
</tr>
<tr>
<td>FIT_START</td>
<td>-</td>
<td>左or上铺满</td>
</tr>
<tr>
<td>FIT_END</td>
<td>-</td>
<td>右or下铺满</td>
</tr>
<tr>
<td>FIT_CENTER</td>
<td>-</td>
<td>居中铺满</td>
</tr>
<tr>
<td>CENTER</td>
<td>-</td>
<td>居中</td>
</tr>
<tr>
<td>CENTER_CROP</td>
<td>-</td>
<td>居中裁剪</td>
</tr>
<tr>
<td>CENTER_INSIDE</td>
<td>-</td>
<td>居中包含</td>
</tr>
<tr>
<td>MATRIX</td>
<td>-</td>
<td>矩阵</td>
</tr>
</tbody></table>

<h2 id="gravity">Gravity</h2>

<aside class="notice" id="gravity">
布局样式。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>LEFT</td>
<td>-</td>
<td>左对齐</td>
</tr>
<tr>
<td>TOP</td>
<td>-</td>
<td>上对齐</td>
</tr>
<tr>
<td>RIGHT</td>
<td>-</td>
<td>右对齐</td>
</tr>
<tr>
<td>BOTTOM</td>
<td>-</td>
<td>下对齐</td>
</tr>
<tr>
<td>START</td>
<td>-</td>
<td>左or上对齐</td>
</tr>
<tr>
<td>END</td>
<td>-</td>
<td>右or下对齐</td>
</tr>
<tr>
<td>CENTER</td>
<td>-</td>
<td>居中对齐</td>
</tr>
<tr>
<td>H_CENTER</td>
<td>-</td>
<td>水平居中对齐</td>
</tr>
<tr>
<td>V_CENTER</td>
<td>-</td>
<td>垂直居中对齐</td>
</tr>
<tr>
<td>FILL</td>
<td>-</td>
<td>铺满</td>
</tr>
<tr>
<td>H_FILL</td>
<td>-</td>
<td>水平铺满</td>
</tr>
<tr>
<td>V_FILL</td>
<td>-</td>
<td>垂直铺满</td>
</tr>
</tbody></table>

<h2 id="ellipsize">Ellipsize</h2>

<aside class="notice" id="ellipsize">
文本省略样式。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>START</td>
<td>-</td>
<td>起始位置省略</td>
</tr>
<tr>
<td>MIDDLE</td>
<td>-</td>
<td>中间位置省略</td>
</tr>
<tr>
<td>END</td>
<td>-</td>
<td>结束为止省略</td>
</tr>
<tr>
<td>MARQUEE</td>
<td>-</td>
<td>跑马灯</td>
</tr>
</tbody></table>

<h2 id="interpolator">Interpolator</h2>

<aside class="notice" id="interpolator">
动画差值器。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>ACCELERATE_DECELERATE</td>
<td>-</td>
<td>先加速后减速插值</td>
</tr>
<tr>
<td>ACCELERATE</td>
<td>-</td>
<td>加速插值</td>
</tr>
<tr>
<td>ANTICIPATE</td>
<td>-</td>
<td>预期插值</td>
</tr>
<tr>
<td>ANTICIPATE_OVERSHOOT</td>
<td>-</td>
<td>预期弹性插值</td>
</tr>
<tr>
<td>BOUNCE</td>
<td>-</td>
<td>回弹插值</td>
</tr>
<tr>
<td>CYCLE</td>
<td>-</td>
<td>环形插值</td>
</tr>
<tr>
<td>DECELERATE</td>
<td>-</td>
<td>减速插值</td>
</tr>
<tr>
<td>LINEAR</td>
<td>-</td>
<td>线性插值</td>
</tr>
<tr>
<td>OVERSHOOT</td>
<td>-</td>
<td>弹性插值</td>
</tr>
</tbody></table>

<h2 id="vieweffect">ViewEffect</h2>

<aside class="notice" id="view_effect">
View特效。
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>NONE</td>
<td>-</td>
<td>无特效</td>
</tr>
<tr>
<td>CLICK</td>
<td>Android</td>
<td>点击水波纹特效</td>
</tr>
<tr>
<td>PARALLAX</td>
<td>-</td>
<td>视差特效</td>
</tr>
</tbody></table>

<h2 id="paintstyle">PaintStyle</h2>

<aside class="notice" id="paint_style">
Canvas画笔样式。参考 <a href="#canvas">Canvas</a>
</aside>

<table><thead>
<tr>
<th>值</th>
<th>平台</th>
<th>备注</th>
</tr>
</thead><tbody>
<tr>
<td>FILL</td>
<td>-</td>
<td>填充</td>
</tr>
<tr>
<td>STROKE</td>
<td>-</td>
<td>中空</td>
</tr>
</tbody></table>

          <h1 id="extends-luaview">Extends LuaView</h1>

<h2 id="scenarios">Scenarios</h2>

<p>虽然LuaView包含了常用的大部分控件，但是开发者有自己的定制需求，这些定制需求可以大致分为以下几种情况</p>

<h3 id="1-native-ui-native-lua">1. 已经有native的UI组件，想让该native组件与lua进行交互。</h3>

<p>如：开发者A在使用LuaView之前，已经开发了一个自定义的View，该自定义View能够完成某些功能，想在lua中使用该组件，实现native与lua互操作。</p>

<h3 id="2-lua">2. 有某些功能，需要与lua码进行交互。</h3>

<p>如以下场景：</p>

<ul>
<li>需要在 native 中调用 lua 函数，执行某个功能，或者得到某个结果。</li>
<li>需要在 lua 调用 native 函数，执行 native 中的某个功能，或者得到某个结果。</li>
</ul>

<h3 id="3">3. 需要使用自己的图片库。</h3>

<p>如：开发者A使用自定义的图片库，而非Glide（LuaView默认图片库）。</p>

<h3 id="4">4. 预定义组件无法满足需求，需要自己实现一套组件。</h3>

<p>如以下场景：</p>

<ul>
<li>开发者A不想使用LuaView内置的Button，而是使用自己开发的Button组件。</li>
<li>开发者想跟LuaView一样，在lua代码中使用完整的组件，并包含自己的API，如 VideoView</li>
</ul>

<h2 id="1-native-ui">1. 已有 Native UI 组件</h2>

<p>开发者A，在自己的项目中，有统一的Native Loading UI，在 lua 中写的页面或UI组件中也需要使用该Loading UI。为了避免重复开发已有功能，LuaView 支持将现有功能通过简单封装，桥接到 lua 层，赋予该 Native UI 与 lua 互操作的能力。既可以在 lua 中创建出该UI，也可以操作该UI，改变其状态或功能，也可以在在该 Native UI 中调用相应的 lua 代码。</p>

<p><br/>
<code class="prettyprint">扩展方式大概分为以下几步：</code></p>

<blockquote>
<p>CustomPanel - Android</p>
</blockquote>
<pre class="highlight plaintext"><code>1. 继承LVCustomPanel

public class CustomLoading extends LVCustomPanel {

    public CustomLoading(Globals globals, LuaValue metaTable, Varargs varargs) {
        super(globals, metaTable, varargs);
    }

    @Override
    public void initPanel() {
        //TODO 在这里创建Native UI
    }
}

2. 实现initPanel方法，创建Native UI，并添加的CustomPanel里

@Override
public void initPanel() {
    //创建Native UI
    final View customLoading = new NativeLoading(getContext());
    LayoutParams layoutParams = LuaViewUtil.createRelativeLayoutParamsWW();
    layoutParams.addRule(RelativeLayout.CENTER_IN_PARENT);
    customLoading.setVisibility(View.VISIBLE);

    //添加到CustomPanel里
    addView(customLoading, layoutParams);
}

3. Native调用Lua

@Override
public void initPanel() {
    //创建Native UI
    final View customLoading = new NativeLoading(getContext());

    //添加View...

    //绑定事件
    customLoading.setOnClickListener(new View.OnClickListener(){
      @Override
      public void onClick(View v) {
        //1. 调用该View的回调，params为函数参数，类型为Object...
        callLuaCallback(params);

        //2. 调用脚本的全局方法，params为函数参数，类型为Object...
        callLuaFunction("globalFun", params);
      }
    });
}

4. LuaView注册CustomPanel

luaview.registerPanel(CustomLoading.class)

或者

luaview.registerPanel("新名称(默认是类名称)", CustomLoading.class)

5. Lua代码

-- 在Lua代码中直接创建CustomPanel对象
local loading = CustomLoading()
loading.frame(0, 0, 100, 100)

loading.callback(function()
  -- Native UI调用该函数
end)

function globalFun(param1, param2)
  -- Native UI调用该函数
end

</code></pre>

<h3 id="a-custompanel">a. 扩展CustomPanel</h3>

<p>在LuaView中有一个CustomPanel组件，用于将已有的Native UI组件进行包装。开发者可以通过扩展CustomPanel来实现现有组件复用。</p>

<h3 id="b-initpanel">b. 实现initPanel()方法</h3>

<p>在initPanel里面创建Native UI组件，并添加到CustomPanel中。
  CustomPanel本身实际上是一个Android的ViewGroup, 所创建的Native UI是该ViewGroup的子View</p>

<h3 id="c-native-ui-lua">c. Native UI 中绑定事件，以便调用 Lua 代码</h3>

<p>在Native UI中事件发生时，通过调用对应脚本的Lua函数，来实现相互通信。目前有两种调用方式
  * 一种是调用脚本的全局方法
  * 一种是调用CustomPanel的Callback方法</p>

<h3 id="d-custompanel-luaview">d. 注册CustomPanel到LuaView</h3>

<p>写好CustomPanel以后，就可以在LuaView启动的时候注册对应的CustomPanel。使用函数registerPanel()</p>

<h3 id="e-lua-custompanel">e. 在Lua中使用CustomPanel</h3>

<p>注册好的CustomPanel，可以在Lua脚本中直接使用，且有View的所有方法，包含容器方法</p>

<h2 id="2-native-lua">2. native-lua 互操作</h2>

<p>开发者A有部分功能需要在Lua中使用，如判断是否登陆，页面跳转等逻辑。</p>

<p><br/>
<code class="prettyprint">扩展方式大概分为以下几步：</code></p>

<blockquote>
<p>Bridge - Android</p>
</blockquote>
<pre class="highlight plaintext"><code>1. 书写Bridge函数

public class LuaViewBridge {
    private Activity mActivity;

    public LuaViewBridge(Activity activity) {
        this.mActivity = activity;
    }

    //页面跳转
    public void openPage(String pageUri){
        Intent intent = new Intent();
        intent.setData(Uri.parse(pageUri));
        mActivity.startActivity(intent);
    }

    //判断是否登陆
    public boolean isLogin(){
        return true;
    }
}

2. 注册Bridge

luaview.register("bridge", new LuaViewBridge())

3. Lua中使用

-- open page
bridge.openPage("http://luaview.github.io")

-- 判断是否login
local isLogin = bridge.isLogin()

</code></pre>

<h3 id="a-bridge">a. 创建Bridge</h3>

<p>在Android中，LuaView的Bridge就是一个简单的Object，任何Object都可以，创建出该Object，注册到LuaView即可实现lua操作Native。</p>

<h3 id="b-bridge">b. 注册Bridge</h3>

<p>使用LuaView.register(&ldquo;bridge&rdquo;, new LuaViewBridge())注册一个bridge对象。</p>

<h3 id="c-lua">c. Lua中使用</h3>

<p>创建出来的bridge可以在lua中直接使用，支持所有基本类型互传。</p>

<h2 id="3">3. 使用自己的图片库</h2>

<p>默认LuaViewSDK使用Glide图片库，第三方可以通过实现ImageProvider来自接入自定义的图片库</p>

<p><br/>
  <code class="prettyprint">扩展方式大概分为以下几步：</code></p>

<blockquote>
<p>自定义图片库 - Android</p>
</blockquote>
<pre class="highlight plaintext"><code>1. 实现ImageProvider接口
public class CustomImageProvider implements ImageProvider {
  /**
   * 下载图片
   * @param imageView
   * @param url
   * @param callback
   */
  void load(final Context context, final WeakReference&lt;BaseImageView&gt; imageView, final String url, final WeakReference&lt;BaseImageView.LoadCallback&gt; callback);

  /**
   * 预下载图片
   * @param context
   * @param url
   * @param callback
   */
  void preload(final Context context, final String url, final BaseImageView.LoadCallback callback);

  /**
   * pause all requests
   * @param context
   */
  void pauseRequests(final ViewGroup view, final Context context);

  /**
   * resume all requests
   * @param context
   */
  void resumeRequests(final ViewGroup view, final Context context);
}

2. 注册ImageProvider

luaview.registerImageProvider(CustomImageProvider.class)
</code></pre>

<h3 id="a-customimageprovider-imageprovider">a. 自定义CustomImageProvider，实现ImageProvider接口</h3>

<p>自定义一个ImageProvider，实现对应的方法。</p>

<h3 id="b-imageprovider">b. 注册ImageProvider</h3>

<p>使用LuaView.registerImageProvider()注册Provider。</p>

<h2 id="4">4. 扩展完整组件</h2>

<p>某些情况下，开发者想要自己实现一整套组件，然后在lua中使用，或者想要覆盖SDK里的内置组件。如，开发者A想要开发一个组件CustomButton组件，在lua中直接使用；或A想要使用自定义的native Button，而非SDK里的Button组件。</p>

<p><br/>
  <code class="prettyprint">扩展方式大概分为以下几步：</code></p>

<blockquote>
<p>扩展完整组件 - Android</p>
</blockquote>
<pre class="highlight plaintext"><code>1. 创建Binder

public class CustomButtonBinder extends BaseFunctionBinder {

    public CustomButtonBinder() {
      //在这里指定名称
    }

    @Override
    public Class&lt;? extends LibFunction&gt; getMapperClass() {
      //TODO 在这里指定方法列表 return CustomButtonMethodMapper.class;
    }

    @Override
    public LuaValue createCreator(LuaValue env, LuaValue metaTable) {
      // Userdata 对象        
    }
}

2. 指定名称、方法映射表、Lua userdata

  a. 指定名称：
  public CustomButtonBinder() {
    super("CustomButton"); //名称为CustomButton
  }

  b. 指定方法列表
  @Override
  public Class&lt;? extends LibFunction&gt; getMapperClass() {
    return CustomButtonMethodMapper.class; //方法列表为CustomButtonMethodMapper类对应的所有方法
  }

  c. Lua userdata
  @Override
  public LuaValue createCreator(LuaValue env, LuaValue metaTable) {
      return new BaseVarArgUICreator(env.checkglobals(), metaTable, getMapperClass()) {//这里使用的UICreator，对应的有BaseVarArgCreator、BaseVarArgUICreator
          @Override
          public ILVView createView(Globals globals, LuaValue metaTable, Varargs varargs) {
              return new CustomButton(globals, metaTable, varargs);
          }
      };
  }


3. 实现 CustomButton，实现 ILVView接口，如果是ViewGroup的话，实现ILVViewGroup接口

public class CustomButton extends Button implements ILVView {
    private UDView mLuaUserdata;

    public CustomButton(Globals globals, LuaValue metaTable, Varargs varargs) {
        super(globals.getContext());
        this.mLuaUserdata = new UDCustomButton(this, globals, metaTable, varargs);
    }

    @Override
    public UDView getUserdata() {
        return mLuaUserdata;
    }
}

4. 实现UDCustomButton，继承自UDView，如果是ViewGroup的话，继承UDViewGroup

public class UDCustomButton extends UDTextView&lt;Button&gt; {
    public UDButton(Button view, Globals globals, LuaValue metatable, Varargs initParams) {
        super(view, globals, metatable, initParams);
    }
}

5. 实现CustomButtonMethodMapper，通过继承不同的MethodMapper来复用已经定义好的方法

@LuaViewLib
public class CustomButtonMethodMapper&lt;U extends UDCustomButton&gt; extends UITextViewMethodMapper&lt;U&gt; {

    private static final String TAG = CustomButtonMethodMapper.class.getSimpleName();
    private static final String[] sMethods = new String[]{
            "customMethod"
    };

    @Override
    public List&lt;String&gt; getAllFunctionNames() {
        return mergeFunctionNames(TAG, super.getAllFunctionNames(), sMethods);
    }

    @Override
    public Varargs invoke(int code, U target, Varargs varargs) {
        final int optcode = code - super.getAllFunctionNames().size();
        switch (optcode) {
            case 0:
                return customMethod(target, varargs);
        }
        return super.invoke(code, target, varargs);
    }

    public LuaValue customMethod(U view, Varargs varargs) {
        //获取参数 varargs.arg(2), 参数从2开始，1的位置是self。具体使用参见SDK实现
        //set方法返回view本身，用于链式调用，get方法返回函数调用值
    }
}

6. 注册CustomButton

luaview.registerLibs(new CustomButtonBinder()))

7. lua调用

local btn = CustomButton()
btn.frame(0, 0, 100, 100)
btn.text("自定义按钮")
btn.customMethod()

</code></pre>

<h3 id="a-binder">a. 创建Binder</h3>

<p>binder用于将native功能绑定到lua中，定义了在lua中的名称、方法映射表、对象。
  通过继承BaseFunctionBinder可以创建一个Binder</p>

<h3 id="b-lua-userdata">b. 指定名称、方法映射表、Lua userdata</h3>

<ul>
<li>名称：是在Lua中使用的直接名称，如Button</li>
<li>方法映射表：是该lua对象拥有的native-lua方法列表，是该组件的完整api列表</li>
<li>lua实体：是lua中对象的实体，是一个Userdata</li>
</ul>

<h3 id="c-custombutton">c. 实现CustomButton</h3>

<p>CustomButton是自定义的Button组件，为了跟Lua进行交互，需要在其内部绑定一个Lua对象。可以通过实现ILVView或者ILVViewGroup接口，实现对应接口来完成。</p>

<h3 id="d-udcustombutton">d. 实现UDCustomButton</h3>

<p>UDXXX是Lua中的Userdata对象，自定义的Userdata可以继承UDView或者UDViewGroup来扩展功能</p>

<h3 id="e-custombuttonmethodmapper">e. 实现CustomButtonMethodMapper</h3>

<p>MethodMapper是Native-Lua方法的映射表，如果想要复用以后的方法表，可以通过继承对应的MethodMapper来实现，如View的话继承LVViewMethodMapper，ViewGroup的话继承LVViewGroupMethodMapper。</p>

<h3 id="f-custombutton">f. 注册CustomButton</h3>

<p>使用luaview.registerLibs()来实现</p>

<h3 id="g-lua">g. lua调用</h3>

<p>注册好后，可以直接在lua代码中使用自定义的库</p>

          <h1 id="examples">Examples</h1>

          <h1 id="tools-for-luaview">Tools for LuaView</h1>

<h2 id="1-luaviewdegbugger">1. LuaViewDegbugger</h2>

<p>LuaViewSDK 的lua代码调试器</p>

<h2 id="2-luaviewbytecodecompiler">2. LuaViewBytecodeCompiler</h2>

<ul>
<li>LuaViewBytecodeCompiler用于将LuaView的源码预编译成Lua bytecode。加速LuaViewSDK for Android的执行</li>
<li>该工具编译出来的bytecode代码只能用于Android端，暂时不能用于iOS端</li>
</ul>

<h3 id="usage">Usage</h3>

<ol>
<li>创建项目普通Java项目ProjA</li>
<li>引入jar包</li>
<li>使用jar包提供的函数对lua代码进行打包(LuaViewBytecodeCompiler类)

<ul>
<li>A：public static byte[] compile(byte[] source, String filename) throws Exception

<ul>
<li>将一个源码的二进制流编译成lua bytecode二进制流</li>
</ul></li>
<li>B：public static void compile(String filePath) throws Exception

<ul>
<li>将给定代码地址的代码编译成lua bytecode并保存在同目录下，文件名为*.luap</li>
</ul></li>
</ul></li>
<li>在Android项目直接使用编译好的bytecode，功能同load函数

<ul>
<li>luaView.loadPrototype(final InputStream inputStream, final String name, final LuaScriptLoader.ScriptExecuteCallback callback)</li>
</ul></li>
</ol>

          <h1 id="changes-log">Changes Log</h1>

<h2 id="v5-5-0-2016-12-todo">V5.5.0 (2016-12) TODO</h2>

<ul>
<li>Canvas 支持</li>
<li>手势 支持</li>
<li>全局坐标</li>
<li>下拉定制</li>
</ul>

<h2 id="v5-4-0-2016-11">V5.4.0 (2016-11)</h2>

<ul>
<li>吸附菜单（CollectionView)</li>
<li>视差动画（ViewEffect.PARALLAX)</li>
<li>圆角图片</li>
<li>Android

<ul>
<li>图片内存回收机制优化</li>
</ul></li>
</ul>

<h2 id="v5-3-0-2016-10">V5.3.0 (2016-10)</h2>

<ul>
<li>WebView</li>
<li>CollectionView 支持按Section、Row进行刷新</li>
<li>Android

<ul>
<li>ViewEffect.CLICK 的 Ripple 支持不同颜色</li>
<li>图片Alpha动画优化</li>
</ul></li>
</ul>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="lua">lua</a>
          </div>
      </div>
    </div>
  </body>
</html>
